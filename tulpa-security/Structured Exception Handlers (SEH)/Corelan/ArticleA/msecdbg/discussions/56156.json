[
  {
    "Id": "189668",
    "ThreadId": "56156",
    "Html": "<p>Hi</p>\r\n<p>Can you please provide some more information about command usage of this extension? I have more than 100 crash dump files to analyze. Can you tell me the Command line options to analyze all the 100 dump files using a single command / batch file</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>Sumit</p>",
    "PostedDate": "2009-05-13T03:33:11.857-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "203461",
    "ThreadId": "56156",
    "Html": "<p>Sumit,</p>\r\n<p>Sorry for the long delay, I've got a batch file for you though, just take the below, throw it in notepad, and then save it as a .bat.&nbsp; Let us know if you have any questions.</p>\r\n<p>Cheers,</p>\r\n<p>Jason</p>\r\n<p>Code begins==&gt;</p>\r\n<pre>@echo off\r\nsetlocal ENABLEEXTENSIONS\r\n@REM get local Path of script\r\nfor /F %%I in (&quot;%0&quot;) do set localDir=%%~dpI\r\n\r\n@REM Check for MSEC.dll in current directory, and in script directory\r\nif not exist .\\msec.dll (\r\n\tif not exist %localDir%\\msec.dll (\r\n\t\techo.\r\n\t\techo MSEC.dll not in current directory, please copy MSEC.dll locally and \r\n\t\techo rerun classify.bat.\r\n\t\techo.\r\n\t\tgoto error\r\n\t) else (\r\n\t\tset msecPath=%localdir%\\msec.dll\r\n\t)\r\n) else (\r\n\tset msecPath=.\\msec.dll\r\n)\r\n\r\n@REM Check that cdb.exe is in the path or local directory\r\nWHERE /Q cdb.exe\r\nIF  ERRORLEVEL 1 (\r\n    echo.\r\n    echo cdb.exe was not found in the local directory or path\r\n    echo.\r\n    goto error\r\n  )\r\n\r\n@REM Validate First Parameter \r\nif /i &quot;%~1&quot; EQU &quot;&quot; goto Usage\r\nif /i &quot;%~1&quot; EQU &quot;/?&quot; goto Usage\r\nif /i &quot;%~1&quot; EQU &quot;-?&quot; goto Usage\r\nif /i &quot;%~1&quot; EQU &quot;/help&quot; goto Usage\r\nif /i &quot;%~1&quot; EQU &quot;-help&quot; goto Usage\r\nif not exit &quot;%~1&quot; (\r\n\techo.\r\n    echo &quot;%~1&quot; could not be found.\r\n    echo.\r\n    goto error\r\n)\r\n\r\n@REM Validate second Parameter\r\nif /i &quot;%~2&quot; EQU &quot;&quot; goto Usage\r\nif exist &quot;%~2&quot; (\r\n  dir /a:d &quot;%~2&quot; &gt; nul\r\n  IF  ERRORLEVEL 1 (\r\n    echo.\r\n    echo &quot;%~2&quot; is a file, the second paremeter should be a directory\r\n    echo.\r\n    goto error\r\n  )\r\n)\r\n\r\n@REM ERROR Checking Is Over\r\nset Hash=\r\nset Type=\r\nset Exploitability=\r\nset tempLog=.\\ExploitableLog-%random%.Log\r\n\r\ncdb -z &quot;%~1&quot; -a%msecPath% -c &quot;.symfix+; .reload; .logopen \\&quot;%tempLog%\\&quot;;!exploitable -m;.logclose;q&quot;\r\n\r\nfor /f &quot;tokens=1* delims=:&quot; %%a in (%tempLog%) do (\r\n\tfor /f &quot;tokens=1*&quot; %%c in (&quot;%%b&quot;) do (\r\n\t   if /i &quot;%%a&quot; EQU &quot;MAJOR_HASH&quot; set MajorHash=%%c\r\n\t   if /i &quot;%%a&quot; EQU &quot;MINOR_HASH&quot; set MinorHash=%%c\r\n\t   if /i &quot;%%a&quot; EQU &quot;SHORT_DESCRIPTION&quot; set Type=%%c\r\n\t   if /i &quot;%%a&quot; EQU &quot;CLASSIFICATION&quot; set Exploitability=%%c\r\n\t)\r\n)\r\n\r\nset ResultDir=%~2\\%CrashDir%\\%Exploitability%\\%type%\\%MajorHash%\\%MinorHash%\r\nmd &quot;%ResultDir%&quot;\r\ncopy /b /y &quot;%~1&quot; &quot;%ResultDir%&quot;\r\ncopy /b /y %tempLog% &quot;%ResultDir%&quot;\r\ndel /q %tempLog%\r\ngoto end\r\n\r\n:usage\r\nEcho classify.bat ^ ^\r\necho.\r\necho Classify.bat will place the specified dump and log into a directory structure as follows:\r\necho.\r\necho ^\\^\\^\\^\r\necho.\r\necho Examples:\r\necho ^\\EXPLOITABLE\\WriteAV\\0x6e05193a\\0x7505193a\r\necho ^\\PROBABLY_EXPLOITABLE\\TaintedDataControlsCodeFlow\\0x6e05193a\\0x7505193a\r\necho ^\\UNKNOWN\\PossibleStackCorruption\\0x6e05193a\\0x7505193a\r\necho.\r\necho Classify.bat requires MSEC.dll to be in the current directory and cdb to be \r\necho in the path.\r\necho.\r\necho To easily run classify.bat against a set of dumps try the following command:\r\necho.\r\necho for /R . ^%%a in (*.dmp) do classify.bat ^%%a C:\\Crashes\r\necho.\r\ngoto error\r\n:error\r\nexit /b 1\r\n:end\r\nexit /b 0</pre>",
    "PostedDate": "2009-06-19T11:25:46.45-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]