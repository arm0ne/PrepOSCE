#!/usr/bin/env ruby
# This script is based on
# Perl script written by Peter Van Eeckhoutte
# http://www.corelan.be
# This script takes a string as argument
# and will produce the opcodes 
# to push this string onto the stack

filename = "pvePushString.rb"
if ARGV.empty?
    puts " usage: #{filename} \"String to put on stack\""
end
#convert string to bytes
strToPush=ARGV[0]
strThisChar=""
strThisHex=""
cnt=0
bytecnt=0
strHex=""
strOpcodes=""
strPush=""
puts "String length : #{strToPush.size}"
puts "Opcodes to push this string onto the stack :\n\n"
while cnt < strToPush.size do
