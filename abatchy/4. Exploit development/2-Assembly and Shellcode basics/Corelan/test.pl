#!/usr/bin/perl
# Perl script written by Peter Van Eeckhoutte
# http://www.corelan.be
# This script takes a string as argument
# and will produce the opcodes 
# to push this string onto the stack
#
if ($#ARGV ne 0) { 
print "  usage: $0 ".chr(34)."String to put on stack".chr(34)."\n"; 
exit(0); 
} 
#convert string to bytes
my $strToPush=$ARGV[0];
my $strThisChar="";
my $strThisHex="";
my $cnt=0;
my $bytecnt=0;
my $strHex="";
my $strOpcodes="";
my $strPush="";
print "String length : " . length($strToPush)."\n";
print "Opcodes to push this string onto the stack :\n\n";
while ($cnt < length($strToPush))
{
  $strThisChar=substr($strToPush,$cnt,1);
 # $strThisHex="\\x".ascii_to_hex($strThisChar);
 }
 print $strThisChar."\n";
 #print $strThisHex."\n";

